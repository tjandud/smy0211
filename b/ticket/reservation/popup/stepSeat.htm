<!DOCTYPE html>
<html lang="ko">
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	<title>ë©œë¡  í‹°ì¼“</title>

    <!-- íŒŒë¹„ì½˜ -->
    <link rel="shortcut icon" type="image/x-icon" href="https://cdnticket.melon.co.kr/resource/image/web/common/pc_32.ico" />

    <!-- IOSìš© -->
    <link rel="apple-touch-icon-precomposed" href="https://cdnticket.melon.co.kr/resource/image/web/common/ios_120.png" />
	<link rel="apple-touch-icon-precomposed" sizes="180x180" href="https://cdnticket.melon.co.kr/resource/image/web/common/ios_180.png" />

    <meta name="viewport" content="width=1126"/><!-- ëª¨ë°”ì¼ ì ‘ì†ì‹œ ì»¨í…ì¸  ë„“ì´ -->
    <meta name="keywords" content="í‹°ì¼“, ì½˜ì„œíŠ¸, í…Œë§ˆ/ì§€ì—­, ë­í‚¹, í‹°ì¼“ì˜¤í”ˆì†Œì‹, ì´ë²¤íŠ¸, FouU, ë§ˆì´í‹°ì¼“" />
    <meta name="description" content="No.1 ìŒì•…í”Œë«í¼ ë©œë¡ ì—ì„œ ì œê³µí•˜ëŠ” ê³µì—° ì˜ˆë§¤ì‚¬ì´íŠ¸. ì½˜ì„œíŠ¸, íŒ¬ë¯¸íŒ…, í˜ìŠ¤í‹°ë²Œ, ì¶”ì²œê³µì—° ì œê³µ" />
    <meta property="og:title" content=""/>
    <meta property="og:image" content=""/>
    <meta property="og:description" content="ë“£ë‹¤Â·ë³´ë‹¤Â·ë§Œë‚˜ë‹¤, ë©œë¡ í‹°ì¼“"/>
	<meta property="og:site_name" content="ë©œë¡ í‹°ì¼“" />
    <meta name="naver-site-verification" content="8912542fdfc7aaf11e289d8bed9e86892deef890"/>
    <script type="text/javascript" src="../../web/common/jquery-3.6.0.min.js"></script>
    <script type="text/javascript" src="../../web/common/jquery-migrate-3.3.2.min.js"></script>
    <script type="text/javascript" src="../../web/common/jquery.inputmask.bundle.js"></script>
    <script type="text/javascript" src="../../web/common/ui_script.js?v=20250825"></script>
    <script type="text/javascript" src="../../web/common/melonweb_openlib.js"></script>
    <script type="text/javascript" src="../../web/common/melonweb_comm.js?t=20220720"></script>
    <script type="text/javascript" src="../../web/common/melonweb_member_external.js?t=20220720"></script>
    <script type="text/javascript" src="../../web/common/webUtils.js?v=20220210"></script>
    <script type="text/javascript" src="../../web/common/CaptchaUtils.js?v=20240116"></script>
    <link rel="stylesheet" type="text/css"
          href="//cdnticket.melon.co.kr/resource/style/web/common/common_onestop-1f4da835a2.css"/>
    <link rel="stylesheet" type="text/css"
          href="//cdnticket.melon.co.kr/resource/style/web/common/onestop-ea2e58911c.css"/>
    <script>var APIURL = '/tktapi', POCURL = '/tktapi_poc', CTX = "";</script>
    <!-- êµ¬ë§¤ì „í™˜ìŠ¤í¬ë¦½íŠ¸2-->
    <!-- Kakao Pixel Code -->
    <script type="text/javascript" charset="UTF-8" src="//t1.daumcdn.net/adfit/static/kp.js"></script>
    <script type="text/javascript">
        kakaoPixel("1432956840521218273").pageView("WEB-ê³µí†µ");
    </script>
    <!-- End Kakao Pixel Code -->

    <script>
// ë¡œì»¬ í…ŒìŠ¤íŠ¸ìš© ê¸°ë³¸ parent ë°ì´í„° ì„¸íŒ…
// ìµœìƒìœ„ windowì—ì„œ parent === window ì´ê¸° ë•Œë¬¸ì—,
// parent.data â†’ window.data ë¥¼ ë°”ë¼ë³´ê²Œ ë¨.
window.data = {
  selectedSeatCount: 0,
  seatdata: {}
};
window.seatData = {};     // ì„ íƒëœ ì¢Œì„ë“¤
window.gradeData = {};    // ë“±ê¸‰ëª… ë§¤í•‘
window.schData = [
  {
    scheduleNo: "SCHED1",
    perfStartDay: "20251231",
    perfStartTime: "1900",
    sellTypeCode: "ST0001",
    orderNo: "1"
  }
];
window.prodData = {
  seatCntDisplayYn: "Y"
};

// ë©œë¡  ì½”ë“œì—ì„œ ì“°ëŠ” parent.* ë“¤ì´ ëª¨ë‘ window.* ë¥¼ ê°€ë¦¬í‚¤ê²Œ ë¨
// (ë³„ë„ ì„¤ì • í•„ìš” ì—†ìŒ, parent === window)
</script>

</head>
<body>

    <script src="/resource/script/phase/deployPhaseUtils.js"></script>
<!-- ë„¤ì´ë²„ ê´‘ê³  ë¡œê·¸ë¶„ì„ -->
<!-- ê³µí†µ ì ìš© ìŠ¤í¬ë¦½íŠ¸ , ëª¨ë“  í˜ì´ì§€ì— ë…¸ì¶œë˜ë„ë¡ ì„¤ì¹˜. ë‹¨ ì „í™˜í˜ì´ì§€ ì„¤ì •ê°’ë³´ë‹¤ í•­ìƒ í•˜ë‹¨ì— ìœ„ì¹˜í•´ì•¼í•¨ -->
<script type="text/javascript" src="//wcs.naver.net/wcslog.js"> </script>
<script type="text/javascript">
    // console.log("##########################################");
    // console.log("##########################################");
    // console.log("ë„¤ì´ë²„ ê´‘ê³  ë¡œê·¸ ë¶„ì„ ê³µí†µ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰");
    // console.log("script_common.jsp");
    // console.log("##########################################");
    // console.log("##########################################");
    if (!wcs_add) var wcs_add={};
    wcs_add["wa"] = "s_585b06516861";
    if (!_nasa) var _nasa={};
    if(window.wcs){
        wcs.inflow("melon.com");
        wcs_do(_nasa);
    }
</script>
<!-- END ë„¤ì´ë²„ ê´‘ê³  ë¡œê·¸ë¶„ì„ -->
<link rel="stylesheet" type="text/css" href="//cdnticket.melon.co.kr/resource/style/web/common/onestop_map-9b67a82c75.css" />
<script src="../../web/common/iscroll-zoom-custom.js"></script>
<script src="../../web/common/iscroll5-ie8.js"></script>
<script src="../../seat/raphael_custom.js?t=201904161200"></script>
<script src="../../seat/EzZMSeatCus.js?t=202507171200"></script>
<script src="../../seat/EzCusObject.js"></script>
<script src="../../seat/EzSeatCusIdx.js"></script>
<script type="text/javascript">

  var brCheck = false;
  var myScroll;
  var zoomFactor = 1.2;

  function loaded() {

      myScroll = new IScroll('#wrapper', {
            zoom: true,
            zoomMax:10,
            probType:1,
            HWCompositing:false,
            tab:true,
            freeScroll: true,
            scrollX: true,
            scrollY: true,
            mouseWheel: true,
            scrollbars: true,
            bounce: false,
            interactiveScrollbars: true,
            fadeScrollbars: false,
            indicators: {
                el: '#minimap',
                shrink: 'scale',
                interactive: true
            },
            wheelAction: 'zoom'
      });
  }
  $('#wrapper').on("touchmove", function (ev) {
        var e = ev.originalEvent;
        if (e.preventDefault) {
            e.preventDefault();
        } else {
            e.returnValue = false;
        }
    });
</script>
<!--[if IE 8]>
<script src="/resource/script/seat/raphael-custom.js?t=201904161200"></script>
<script type="text/javascript">
brCheck = true;
$(function(){
    $('#wrapper').bind('mousedown', function(e){
        e.preventDefault();
        $(this).data({'drag':1, 'x':e.pageX, 'y':e.pageY});
        $(this).css({'cursor':'move'});
    }).bind('mousemove', function(e) {
        var sc = $('#scroller');
        if ($(this).data('drag') == 1) {
            dX = e.pageX - $(this).data('x');
            dY = e.pageY - $(this).data('y');
            dT = parseFloat(sc.css('top'))+dY;
            dL = parseFloat(sc.css('left'))+dX;
            sc.css({'top':dT, 'left':dL});
            $(this).data({'x':e.pageX, 'y':e.pageY});
        };
    }).bind('drag', function(e) {
        e.preventDefault();
    }).bind('mouseup', function(e){
        $(this).removeData('drag');
        $(this).css({'cursor':'auto'});
    });
});
</script>
<![endif]-->
<div class="section_onestop" id="section_onestop">
    <!--ì¢Œì„ì„ íƒ  ì˜ì—­-->
    <div class="wrap_select">
        <div class="box_seat_top">
            <h3 class="tit_seat">ì¢Œì„ ì„ íƒ<span class="tit_s txt_prod_name"></span>
                <span class="seat_wrap_sel">
                    <!-- ì…€ë ‰íŠ¸ë°•ìŠ¤ -->
                    <select id="scheduleNo" name="scheduleNo" class="sel_cate" onChange="selectSchedule(this);" onfocus="setOriginNo(this);">
                    </select>
                </span>
            </h3>
        </div>
        <!-- ì¢Œì„ì˜ì—­-->
        <div class="wrap_seat">
            <div class="btn_extension"><a href="#" class="btn_plus" id="btn_map_p">í™•ëŒ€</a><a href="#" class="btn_minus" id="btn_map_m">ì¶•ì†Œ</a></div>
            <div id="wrapper">
                <div id="scroller">
                    <div id="ez_canvas" style="width:100%"></div>
                </div>
            </div>
            <div class="wrap_seat_box">
            <div class="seat_box "><!-- on class ì»¨íŠ¸ë¡¤ -->
                <div class="seat_btn" id="txtSelectSeatInfo" onclick="$(this).parent().toggleClass('open');return false;">ì¢Œì„ì„ ì„ íƒí•´ ì£¼ì„¸ìš”</div>
                <div class="seat_choice">
                    <ul id="partSeatSelected" class="seat_info">
                    </ul>
                </div><!-- //seat_choiceë -->
            </div>
            </div>
        </div>
        <!--// ì¢Œì„ì˜ì—­-->
    </div>
    <!--// ì¢Œì„ì„ íƒ  ì˜ì—­-->
    <!--í‹°ì¼“ ì •ë³´ ì˜ì—­-->
    <div class="wrap_ticket_info">
        <h2 class="logo_onestop"><a href="#none"><img src="https://cdnticket.melon.co.kr/resource/image/web/onestop/logo_onestop.png" alt="Melon í‹°ì¼“"></a></h2>
        <div class="box_info box_map">
			<div class="minimap_scroller" id="minimap_scroller">
				<div class="map_seat">
					<div   id="iez_canvas"></div>
				</div>
			</div>
			<div>
				<div id="minimap">
					<div id="minimap-indicator"></div>
				</div>
			</div>
        </div>
        <div class="wrap_seat_list ">
            <!-- ê¸°ë³¸ ì¢Œì„ë“±ê¸‰/ì”ì—¬ì„-->
            <div class="seat_list">
                <h3 class="select_tit">ì¢Œì„ë“±ê¸‰/ì”ì—¬ì„<span class="ico_info" onmouseover="toolTip('layer_ticket');">ìœ ì˜ì‚¬í•­</span><a href="#none" id="btnReloadSchedule" class="btn_flexible btn_flexible_ico2 btn_detail"><span>ìƒˆë¡œê³ ì¹¨</span></a></h3>
                    <div class="box_seat">
                        <div class="box_seat_inner box_seat_area">
                        <table class="tbl">
                                <caption class="hide"></caption>
                                <colgroup>
                                    <col style="width:26px;" />
                                    <col />
                                    <col style="width:65px;" />
                                    <col style="width:60px;" />
                                </colgroup>
                                <tbody id="partSeatGrade">
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <!--ìœ ì˜ì‚¬í•­ ë ˆì´ì–´íŒì—…-->
                    <div class="layer_ticket" id="layer_ticket" style="position:absolute;top:15px;left:0;width:238px;">
                        <div class="layer_arr" style="left:114px;"></div>
                            <div class="tk_header">
                                <div class="tk_header1">
                                    <span class="tk_tit"></span>
                                </div>
                            </div>
                            <div class="tk_middle">
                                <div class="tk_middle1">
                                    <div>
                                        <p>ì¢Œì„ì„ íƒ ì´í›„ 5ë¶„ì´ë‚´ ê²°ì œê°€ ì™„ë£Œë˜ì§€ ì•Šì„ ì‹œ ì„ íƒí•˜ì‹  ì¢Œì„ì˜ ì„ ì  ê¸°íšŒë¥¼ ìƒê²Œ ë©ë‹ˆë‹¤.</p>
                                    </div>
                                </div>
                        </div>
                        <div class="tk_footer"><div class="tk_footer1"></div></div>
                    </div>
                    <!--// ìœ ì˜ì‚¬í•­ ë ˆì´ì–´íŒì—…-->
            </div>
            <!--//ê¸°ë³¸ ì¢Œì„ë“±ê¸‰/ì”ì—¬ì„-->
        </div>
        <div class="box_info_bm">
            <div class="btn_onestop">
                <span class="button btNext"><a href="#" id="nextTicketSelection" class="btnOne btnOneB">ì¢Œì„ ì„ íƒ ì™„ë£Œ<em class="one_arr next_ar">ë‹¤ìŒ</em></a></span>
            </div>
        </div>
    <!--// í‹°ì¼“ ì •ë³´ ì˜ì—­ -->
    </div>
</div>

<script>
// ğŸ”§ ë¡œì»¬ í…ŒìŠ¤íŠ¸ìš© init ì˜¤ë²„ë¼ì´ë“œ
function init() {
  // ê°„ë‹¨í•œ ìŠ¤ì¼€ì¤„ ì˜µì…˜ í•˜ë‚˜ë§Œ ì„¸íŒ…
  var $sel = $("#scheduleNo");
  $sel.empty();
  $sel.append(
    $('<option/>', {
      value: 'SCHED1',
      text: '2025.12.31 (ìˆ˜) 19:00'
    })
  );

  // ì•ˆë‚´ ë¬¸êµ¬ë§Œ ì„¸íŒ…
  $("#txtSelectSeatInfo").text("ì¢Œì„ì„ ì„ íƒí•´ ì£¼ì„¸ìš” (ë°ëª¨ ëª¨ë“œ)");
  $("#nextTicketSelection").parent().removeClass("on");
}

// ì‹¤ì œ ë©œë¡  ì„œë²„ì™€ í†µì‹ í•˜ëŠ” ë¶€ë¶„ ì „ë¶€ ë§‰ê¸°
function getSeatList() {
  console.log("getSeatList() - ë¡œì»¬ ë°ëª¨: ì„œë²„ í˜¸ì¶œ ìƒëµ");
}

function searchSummaryList() {
  console.log("searchSummaryList() - ë¡œì»¬ ë°ëª¨: ì„œë²„ í˜¸ì¶œ ìƒëµ");
  $("#partSeatGrade").html(
    '<tr>' +
      '<th class="seat_color"><em class="seat_color seat_vip" style="background-color:#e91e63"></em></th>' +
      '<td class="seat_name">VIPì„</td>' +
      '<td class="price">150,000ì›</td>' +
      '<td class="seat_remain">100ì„</td>' +
    '</tr>'
  );
}

function valiProductSchedule() {
  console.log("valiProductSchedule() - ë¡œì»¬ ë°ëª¨: ìœ íš¨ì„± ê²€ì‚¬ ìƒëµ");
}
</script>

<!-- ZAM-netfunnel -->
<script type="text/javascript" src="/resource/script/web/common/netfunnel.js"></script>

<script type="text/javascript">
    function goTicketType() {
        var rtchk = true;
        if (parent.data.selectedSeatCount <= 0) {
            alert("ì„ íƒëœ ì¢Œì„ì´ ì—†ìŠµë‹ˆë‹¤.");
            rtchk = false;
        }else {
            var params		= parent.$("#sForm").serializeArray();
            var chkSeatCount	= 0;

            $.each(parent.seatData, function(key, val){
                params.push({name: "seatId"              , value: val.sid});
                params.push({name: "clipSeatId"          , value: val.csid});
                chkSeatCount++;
            });
            params.push({ name : "chkcapt"    , value : Captcha.getData()});

            $.ajax({
                type                : "POST"
                , dataType          : "jsonp"
                , url               : APIURL + "/reservation/prodlimit.json?v=1"
                , async             : false
                , data              : params
                , success           : function(result) {
                    if(result.result == "0000") {
                        var cnt = 0;
                        $.each(parent.seatData, function (key, val) {
                            parent.$("#sFormSub").append('<input type="hidden" id="seatIds' + cnt + '" name="seatIds" value="' + val.sid + '">');
                            cnt++
                        });

                        var sf = parent.document.sForm;
                        var sfs = parent.document.sFormSub;

                        //encrpytedSeatIds, inter
                        sfs.encryptedSeatIds.value = result.encryptedSeatIds;
                        sfs.interlockTid.value = result.interlockTid;

                        sfs.scheduleNo.value = sf.scheduleNo.value;
                        sfs.flplanTypeCode.value = sf.flplanTypeCode.value;
                        sfs.seatTypeCode.value = sf.seatTypeCode.value;
                        sfs.target = "oneStopFrame";
                        sfs.action = CTX + "/reservation/popup/stepTicket.htm";
                        sfs.submit();

                        for (var i = 0; i < cnt; i++) {
                            parent.$("#seatIds" + i).remove();
                        }
                    } else {
                        if (result.code != 'T0002')         // ì¸ì¦ì˜ˆë§¤(ìº¡ì± ) ë¯¸ì™„ë£Œì‹œ  alert ì—†ì´ íŒì—…ë§Œ í‘œì¶œí•˜ê¸° ìœ„í•¨
                            alert(result.message);

                        if (result.code == "T8270" || result.code == "T8280") {
                            init();
                        } else if (result.code == "T9110") {
                            parent.rsrvPopupClose();
                        } else if (result.code == 'T0002') {                // T0002 : ì¸ì¦ ë¯¸ì™„ë£Œì‹œ
                            parent.captchaObj.show();
                            Captcha.setData('');
                        }
                    }
                }
                , error             : function(e) {
                    alert("ë‹¤ì‹œ ì‹œë„ë¶€íƒë“œë¦½ë‹ˆë‹¤.");
                }
            });
        }
    }

    

    function getSeatList() {
        parent.data.seatdata        = {};
        parent.seatData             = {};
        var prodId		= parent.$("#prodId").val();
        var scheduleNo	= parent.$("#scheduleNo").val();
        var blockId		= parent.$("#blockId").val();
        var url = parent.isLottery ? "/product/seat/seatMapListLottery.json" :"/product/seat/seatMapList.json";
        $.ajax({
              type : "GET"
            , dataType : "jsonp"
            , cache : true
            , url : APIURL + url
            , async : false
            , data : {
                    v: 1
                  , prodId: prodId
                  , scheduleNo: scheduleNo
                  , blockId: blockId
                  , pocCode: parentData.pocCode
                  , corpCodeNo: getCookie('corpCodeNo')
            }
            , jsonpCallback: "getSeatListCallBack"
            , success       : function(result) {
            	if(result.code=="T9110"){
            		alert(result.message);
            		parent.self.close();
            	}
            	
            	if(result.code=="T9217"){
            		alert(result.message);
            	}
            	
                seatData            = result.seatData;

                if(seatData != undefined ){
                    var bBlock = false;
                    var hh = $(window).height() - $('#header').height() - $('#fixed_bottom').height() + $('.seat_btn').height();
                    if(seatData.mt == 'BLOCK'){
                        bBlock = true;
                        $('#minimap-indicator').css('visibility', 'hidden');
                        $(".area").html(parent.$("#areaNo").val())
                        $(".box_fix_info").show();
                        $('.wrap_seat').addClass('type4');
                        $("#header").css('z-index', '1');
                        hh = $(window).height() - $('#header').height() - $('#fixed_bottom').height() + $('.seat_btn').height() - $(".box_fix_info").height();
                        $('.box_fix_info').css('z-index', '1');
                        $('.map').css('z-index', '2');

                    }else{
                        $('#minimap-indicator').css('visibility', 'visible');
                        $(".box_fix_info").hide();
                        $('.wrap_seat').removeClass('type4');
                    }
                    $('#ez_canvas').css('width', $('.wrap_seat').width()+'px');
                    $('#scroller').css('width', $('.wrap_seat').width()+'px');
                    $('#wrapper').css('width', $('.wrap_seat').width()+'px');
                    $('#ez_canvas').css('height', ($('.wrap_seat').height())+'px');
                    $('#scroller').css('height', ($('.wrap_seat').height())+'px');
                    $('#wrapper').css('height', ($('.wrap_seat').height())+'px');

                    fnLoadSeatMap(seatData, parent.lmt, bBlock);

                    $("#partSeatSelected").empty();
                    parent.data.selectedSeatCount = "0";
                    setSelectSeatCount();

                }
            }
            , error         : function(e) {
            		setLoading(false);
            		alert("ë‹¤ì‹œ ì‹œë„ë¶€íƒë“œë¦½ë‹ˆë‹¤.");
        			location.reload(true);
            }
       });
    }

    function removeAllSelectedSeat(){
        
        selectedCount = 0;
        parent.data.selectedSeatCount = selectedCount;
        setSelectSeatCount();

        for( var i in parent.seatData){
            var objectid     = "selectedSeat" + i;
            $("#" + objectid).remove();
            delete parent.seatData[i];

        }
    }

    function setProdSeat() {
        $(".txt_prod_seat").empty();
        $.each(parent.seatData, function(key, val) {
            $(".txt_prod_seat").append(val.title + "<br>");
        });
    }

    SeatInfo = function(id, grade, tit, st, csid, gn)
    {
        this.sid			= id;
        this.grade		= grade;
        this.title		= tit;
        this.seatType	= st;
        this.csid 		= csid;
        this.gn			= gn;
    }

    function selectSeat(sid, pSeatGrade, pSeatTitle, selectCount, pSeatTypeCode, pClipSeatId, pSeatGradeNm) {
        var objectid     = "selectedSeat" + sid;
        if ($("#"+objectid).get() == null || $("#"+objectid).get() == "") {
            $("<li id=\"" + objectid + "\">").html(pSeatTitle +"<input type='hidden' name='seat_id' value='"+sid+"'/>").appendTo($("#partSeatSelected"));
            parent.seatData[sid] = new SeatInfo(sid, pSeatGrade, pSeatTitle, pSeatTypeCode, pClipSeatId, pSeatGradeNm);
            parent.$("#seatTypeCode").val(pSeatTypeCode);
        }
        parent.data.selectedSeatCount = selectCount;
        setSelectSeatCount();
    }
    function unselectSeat(sid, selectCount){
        var objectid     = "selectedSeat" + sid;
        $("#" + objectid).remove();
        delete parent.seatData[sid];
        parent.data.selectedSeatCount = selectCount;
        setSelectSeatCount();
    }

    function selectNASeat(sid, pSeatGrade, pSeatTitle, selectCount, pSeatTypeCode){
        removeAllSelectedSeat();
        var objectid     = "selectedSeat" + sid;
        $("<li id=\"" + objectid + "\">").html("<input type='hidden' name='seat_id' value='"+sid+"'/>").appendTo($("#div_seat_selected"));
        parent.seatData[sid]        = new SeatInfo(sid, pSeatGrade, pSeatTitle, pSeatTypeCode);
        parent.$("#seatTypeCode").val(pSeatTypeCode);
        parent.data.selectedSeatCount = 1;
        goTicketType();
    }

    function setSelectSeatCount() {
        var selectCount         = parent.data.selectedSeatCount;
        if (selectCount > 0) {
            $("#txtSelectSeatInfo").html("ì„ íƒí•œ ì¢Œì„ ì´ <span class=\"txt_seat\">" + selectCount + "ì„</span>ì´ ì„ íƒë˜ì—ˆìŠµë‹ˆë‹¤.");
            $("#nextTicketSelection").parent().addClass("on");
        }
        else {
            $("#txtSelectSeatInfo").html("ì¢Œì„ì„ ì„ íƒí•´ ì£¼ì„¸ìš”.");
            $("#nextTicketSelection").parent().removeClass("on");
        }
    }

    function searchSummaryList() {
        var params = parent.$("#sForm").serialize();
        var perfDate = parent.$("#perfDate").val();
        var url = parent.isLottery ? "/product/summaryLottery.json?v=1" :"/product/summary.json?v=1";

        $.ajax({
            type            : "POST"
            , dataType      : "jsonp"
            , cache         : true
            , url           : APIURL + url
            , async         : false
            , data          : {
                                prodId: parentData.prodId
                              , pocCode: parentData.pocCode
                              , scheduleNo: parent.$("#scheduleNo").val()
                              , perfDate: perfDate
                              , corpCodeNo:getCookie('corpCodeNo')
                              }
            , jsonpCallback : "getBlockGradeSeatCountCallBack"
            , success       : function(result) {
                bindSummaryList(result.summary);
            }
            , error         : function(e) {
            		setLoading(false);
            		alert("ë‹¤ì‹œ ì‹œë„ë¶€íƒë“œë¦½ë‹ˆë‹¤.");
            		location.reload(true);
            }
        });
    }

    function bindSummaryList(list) {
        $("#partSeatGrade").html("");
        $.each(list, function(key, val) {
            $("<tr/>")
            .append("<th class=\"seat_color\"><em class=\"seat_color seat_vip\" style=\"background-color:" + val.gradeColorVal + "\"></em></th>")
            .append("<td class=\"seat_name\">" + val.seatGradeName + "</td>")
            .append("<td class=\"price\">" + addComma(val.basePrice) + "ì›</td>")
            .append(parent.prodData.seatCntDisplayYn == "Y" ? "<td class=\"seat_remain\">" + addComma(val.realSeatCntlk) + "ì„</td>" : "<td class=\"seat_remain\"></td>")
            .appendTo($("#partSeatGrade"));
            parent.gradeData[val.seatGradeNo]      = val.seatGradeName;
        });
        setLoading(false);
    }

    function bindScheduleList() {
        var scheduleList        = $("#scheduleNo");
        var scheduleNo          = parent.$("#scheduleNo").val();
        var schtitle            = "";
        var schDate             = "";
        var schTime             = "";

        scheduleList.empty();
        $.each(parent.schData, function(key, val) {
            schtitle                = "";
            schDate                 = val.perfStartDay;
            schTime                 = val.perfStartTime;

            schtitle                = schDate.substr(0,4) + "." + schDate.substr(4,2) + "." + schDate.substr(6,2) + " (" + getWeekDay(schDate, "", "1") + ") ";
            schtitle                += schTime.substr(0,2) + ":" + schTime.substr(2,2);

         	// ## 20181207 Ultra ##  (new add)
            schtitle = parent.checkDateUnsettled(schDate, schTime, schtitle);
            
            var schoption           = $("<option />").val(val.scheduleNo).text(schtitle);
            if (scheduleNo == val.scheduleNo) {
                schoption.attr({selected: "selected"});
            }

            scheduleList.append(schoption);
        });
    }

    /**
     * ì´ˆê¸° ê°’ì„ ì €ì¥.
     */
    var setOriginNo = function(_this){
        _this.originValue = _this.value;
    };
    /**
     * ì„ íƒí•œ ìŠ¤ì¼€ì¥´ì„ ì¸ì¦í•¨.
     */
    var selectSchedule = function(_this) {
        var scheduleNo = _this.value;
        var sellTypeCode        = "";
        var orderNo             = "";
        parent.gradeData = {};

        $.each(parent.schData, function(key, val) {
            if (scheduleNo == val.scheduleNo) {
                sellTypeCode        = val.sellTypeCode;
                orderNo             = val.orderNo;
            }
        });

        if(sellTypeCode === 'ST0001'){
            selectedSchedule(scheduleNo, sellTypeCode, orderNo);
        }else{
			var _self = this;

			_self.resolveFailedValidation = function(){
				var checkMsg = 'ì„ ì˜ˆë§¤';
				if(sellTypeCode === 'ST0002'){
					
				}else if(sellTypeCode === 'ST0003'){
					checkMsg = 'ì¶”ì²¨ì˜ˆë§¤';
				}
				
				alert(checkMsg+" ì¸ì¦ ì •ë³´ë¥¼ í™•ì¸ í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");

				_this.value = _this.originValue;
			};

			_self.resolve = function(result){
				if(result.data.authYn === 'Y'){
					selectedSchedule(scheduleNo, sellTypeCode, orderNo);
				}else{
					_self.resolveFailedValidation();
				}
			};

			_self.reject = function(e){
				_self.resolveFailedValidation();
			};

			checkAuth(sellTypeCode, orderNo, _self.resolve, _self.reject);
		}
    };
    
    var checkAuth = function(sellTypeCode, sc, resolve, reject) {
        var trgt = '';
        if(sellTypeCode === 'ST0002'){
            trgt = 'prersrv';
        }else if(sellTypeCode === 'ST0003'){
            trgt = 'pickrsrv';
        }
        $.ajax({
            type            : "POST"
            , dataType      : "jsonp"
            , url           : APIURL + "/"+ trgt +"/usercond.json?v=1"
            , async         : false
            , data          : {
                                prodId: parentData.prodId
                              , pocCode: parentData.pocCode
                              , sellTypeCode: sellTypeCode
                              , sellCondNo: sc
                              }
            , jsonpCallback: "chekUserCond"
            , success         : function(result) {
                resolve(result);
            }
            , error           : function(e) {
                reject(e);
            }
       });
    };

    function selectedSchedule(scheduleNo, sellTypeCode, orderNo) {
		parent.$("#sellTypeCode").val(sellTypeCode);
		parent.$("#scheduleNo").val(scheduleNo);
		parent.$("#sellCondNo").val(orderNo);
        parent.$("#blockId").val("");
		parent.reset();
    }

    function init() {
        setLoading(true);
        valiProductSchedule();
        
        getSeatList();
        
        bindScheduleList();
        
        searchSummaryList();

        parent.setProdSchedule();

        parent.data.selectedSeatCount = 0;

        myScroll.zoom(0);

        if (parent.$("#trafficCtrlYn").val() == "Y") {
            //Netfunnel ëª…ì‹œì  ì™„ë£Œì²˜ë¦¬
            NetFunnel_aliveNotice(
                {
                    ipblock: function(ev, ret) {
                        return false;
                    },
                    block: function(ev,ret) {
                        alert(ret.data.msg);
                        return false;
                    }
                }
            );
        }
    }

    function valiProductSchedule(){
        if (parent.$("#scheduleNo").val() != "") {
            $.ajax({
                type            : "POST"
                , dataType      : "jsonp"
                , cache         : true
                , url           : POCURL + "/performance/getProdSellState.json?v=1"
                , async         : false
                , data          : {
                                    prodId: parentData.prodId
                                  , scheduleNo: parent.$("#scheduleNo").val()
                                  }
                , jsonpCallback : "getValiProductScheduleCallBack"
                , success         : function(result) {
                    if(result.result != 0){
                        alert("íŒë§¤ê°€ëŠ¥ ìƒíƒœê°€ ì•„ë‹™ë‹ˆë‹¤.");
                        parent.window.open("about:blank", "_self").close();
                    }
                }
                , error           : function(e) {
                    setLoading(false);
                }
           });
        }else{
        		setLoading(false);
        }
    }
    
    var parentData = {};
    $('#section_onestop').ready(function() {
        parentData.prodId = parent.$("#prodId").val();
        parentData.pocCode = parent.$("#pocCode").val();
        loaded();
        init();
        InitBody();

        $("#btnChangeBlocK").click(function(event) {
            event.preventDefault();
            popupBlock();
        });

        $("#nextTicketSelection").click(function(event) {
            event.preventDefault();
            if (parent.data.selectedSeatCount > 0) goTicketType();
        });

        $("#btnReloadSchedule").click(function(event) {
            event.preventDefault();
            init();
        });

        $('#btn_map_m').click(function(event) {
            event.preventDefault();
            myScroll.zoom(myScroll.scale - zoomFactor);

        });
        $('#btn_map_p').click(function(event) {
            event.preventDefault();
            myScroll.zoom(myScroll.scale + zoomFactor);
        });
    });

    function popupBlock() {
        var params = parent.$("#sForm").serialize();
        $.ajax({
            type           : "POST"
            , url          : CTX + "/product/include/block.htm"
            , async        : false
            , data         : params
            , success      : function(result) {
                $("#popup_block_selection").html(result);
                $("#popup_block_selection").show();
            }
            , error        : function(e) {
                alert("ì ì‹œ ì„œë¹„ìŠ¤ê°€ ì§€ì—°ë˜ê³  ìˆìŠµë‹ˆë‹¤.");
                $("#popup_block_selection").hide();
            }
        });
    }

    function setLoading (isloading) {
        paysync         = isloading;
        if (isloading) {
	        	loadingOpen(" ");
        }
        else {
            setTimeout(function(){
            		loadingClose();	
            }, 500);
        }
    }

</script>
</body>
</html>
